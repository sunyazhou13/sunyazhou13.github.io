---
title: ä½¿ç”¨Masonryçº¦æŸå®ç°ç®€å•çš„é«˜çº§æ‹–æ‹½è§†å›¾
categories: [ioså¼€å‘]
tags: [ios, macos]
date: 2019-09-26 20:05:20
---


![](/assets/images/20190926MasonryPanViewDemo/panviewdemo.gif)


# å‰è¨€

æœ¬æ–‡å…·æœ‰å¼ºçƒˆçš„ä¸ªäººæ„Ÿæƒ…è‰²å½©,å¦‚æœ‰è§‚çœ‹ä¸é€‚,è¯·å°½å¿«å…³é—­. æœ¬æ–‡ä»…ä½œä¸ºä¸ªäººå­¦ä¹ è®°å½•ä½¿ç”¨,ä¹Ÿæ¬¢è¿åœ¨è®¸å¯åè®®èŒƒå›´å†…è½¬è½½æˆ–ä½¿ç”¨,è¯·å°Šé‡ç‰ˆæƒå¹¶ä¸”ä¿ç•™åŸæ–‡é“¾æ¥,è°¢è°¢æ‚¨çš„ç†è§£åˆä½œ. å¦‚æœæ‚¨è§‰å¾—æœ¬ç«™å¯¹æ‚¨èƒ½æœ‰å¸®åŠ©,æ‚¨å¯ä»¥ä½¿ç”¨RSSæ–¹å¼è®¢é˜…æœ¬ç«™,è¿™æ ·æ‚¨å°†èƒ½åœ¨ç¬¬ä¸€æ—¶é—´è·å–æœ¬ç«™ä¿¡æ¯.



## èƒŒæ™¯

æœ€è¿‘å¼€å‘é‡åˆ°ä¸€ä¸ªä¸Šå›¾çš„éœ€æ±‚,åšä¸€ä¸ªæŒ‚ä»¶èƒ½å››å¤„æ‹–åŠ¨å¹¶ä¸”ä¸Šè¾¹è¿˜æ—¶ä¸æ—¶çš„å±•ç¤ºä¸€ä¸ªtipsæ°”æ³¡çš„`Label`,åœ¨å°½é‡ä½¿ç”¨å°‘çš„ä»£ç æ¥å®ç°è¿™ä¸ªåŠŸèƒ½,ä½œä¸ºæˆ‘æ‰‹ä¸€åiOSå¼€å‘äººå‘˜å¿…é¡»ä¸¥æ ¼è€ƒç©¶è¿™ä¸ªéœ€æ±‚,æ˜¾ç„¶è¿™æœ‰ç‚¹éº»çƒ¦,ä¸€è´¯æ‡’æƒ°æˆ‘çš„å®åœ¨ä¸æƒ³è®¡ç®—å“ªä¸ªè¾¹å“ªä¸ªè§’ç”šè‡³æ»‘åŠ¨åˆ°å“ªé‡Œçš„`frame`,è®¡ç®—frameè¿™æ—¢å¬èµ·æ¥å¯ç¬‘åˆè§‰çš„æ²¡ä»€ä¹ˆæŠ€æœ¯å«é‡. ä¸ºäº†è®©ä»£ç é‡å°‘å¹¶ä¸”èƒ½æ»¡è¶³éœ€æ±‚,æˆ‘é€‰æ‹©ä½¿ç”¨Masonryæ¥å®ç°è¿™ä¸ªåŠŸèƒ½


## å¼€æ

é¦–å…ˆæˆ‘æèµ·ä¹‹å‰æˆ‘å»ºè®®å¤§å®¶çœ‹ä¸‹[åœŸåœŸå“¥](http://tutuge.me/)çš„[æœ‰è¶£çš„Autolayoutç¤ºä¾‹1~5Masonryå®ç°æ–‡ç« ](http://tutuge.me/tags/Masonry/),æœ¬æ–‡ä¹Ÿæ˜¯å‚è€ƒåœŸåœŸå“¥çš„æ–‡ç« å­¦ä¹ å†™å‡ºçš„,è§ç¬‘äº†å„ä½,ä¸ªäººè®¤ä¸ºåœŸåœŸå“¥çš„æ–‡ç« ç®€ç›´å°±æ˜¯Masonryè‡ªåŠ¨å¸ƒå±€çš„æ ·æ¿æ•™ç¨‹,å¼ºçƒˆå»ºè®®å…¥é—¨çš„å°ä¼™ä¼´æˆ–è€…é«˜æ‰‹ç»å¸¸å¤å†™.


ä¸‹é¢çš„å›¾æ˜¯åœŸåœŸå“¥å®ç°çš„demo  
![](/assets/images/20190926MasonryPanViewDemo/tutugeMasonry1.gif)

![](/assets/images/20190926MasonryPanViewDemo/tutugeMasonry2.gif)


ä½†æˆ‘çš„é—®é¢˜æ˜¯æ€ä¹ˆä¿è¯é‚£ä¸ªtipçš„æ°”æ³¡labelå·¦å³æ‹–æ‹½èƒ½è¾—è½¬è…¾æŒªçš„å…è®¸logoå›¾åƒä¹‹é—´æœ‰`æ—·é‡ç§»åŠ¨`

## ä»£ç å®ç°æ—·é‡ç§»åŠ¨


é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªdemo,å¾ˆç®€å•VCçš„demoå°±è¡Œ åˆ›å»ºç›¸å…³ç»¿è‰²èƒŒæ™¯è§†å›¾å’Œå›¾åƒimageViewä»¥åŠtipLabelçš„æ°”æ³¡è§†å›¾,å…·ä½“ä»£ç æˆ‘è´´äº†å‡ºæ¥,æˆ‘å°±ä¸å•°å—¦å¦‚ä½•åˆ›å»ºå…¶å®ƒè§†å›¾äº†xibæ‹–æ‹½ä¸€ä¸‹å°±è¡Œäº†.

``` objc
#import "ViewController.h"
#import <Masonry/Masonry.h>

@interface ViewController ()
@property (weak, nonatomic  ) IBOutlet UIView        *greenView;
@property (weak, nonatomic  ) IBOutlet UIImageView   *widgetView;
@property (weak, nonatomic  ) IBOutlet UILabel       *bubbleTitleLabel;

@property (nonatomic, strong) MASConstraint *leftConstraint; //å·¦ä¾§çº¦æŸå˜é‡
@property (nonatomic, strong) MASConstraint *topConstraint;  //é¡¶éƒ¨çº¦æŸå˜é‡

@end


```

è¿™é‡Œå¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ª`leftConstraint `å’Œ`topConstraint `çš„çº¦æŸå…¨å±€å˜é‡,è¿™ä¸¤ä¸ªå°±æ˜¯å®ç°æ‹–æ‹½çš„æ—¶å€™æ”¹å˜çº¦æŸçš„åç§»é‡æ¥å®ç°çš„.å…·ä½“ä»£ç å¦‚ä¸‹


``` objc
CGFloat screenWidth = [UIScreen mainScreen].bounds.size.width;
CGFloat screenHeight = [UIScreen mainScreen].bounds.size.height;
[self.widgetView mas_makeConstraints:^(MASConstraintMaker *make) {
    // è®¾ç½®è¾¹ç•Œæ¡ä»¶çº¦æŸï¼Œä¿è¯å†…å®¹å¯è§ï¼Œä¼˜å…ˆçº§1000
    make.left.greaterThanOrEqualTo(self.greenView.mas_left);
    make.right.lessThanOrEqualTo(self.greenView.mas_right);
    make.top.greaterThanOrEqualTo(self.greenView.mas_top);
    make.bottom.lessThanOrEqualTo(self.greenView.mas_bottom);
    
    self.leftConstraint = make.centerX.equalTo(self.greenView.mas_left).with.offset(screenWidth - 20).priorityHigh(); // ä¼˜å…ˆçº§è¦æ¯”è¾¹ç•Œæ¡ä»¶ä½
    self.topConstraint = make.centerY.equalTo(self.greenView.mas_top).with.offset(screenHeight - 100).priorityHigh(); // ä¼˜å…ˆçº§è¦æ¯”è¾¹ç•Œæ¡ä»¶ä½
    make.width.height.mas_equalTo(@100);
}];
```
ä¸Šè¾¹çš„`greaterThanOrEqualTo`å’Œ`lessThanOrEqualTo`éƒ½æ˜¯é™åˆ¶æŒ‚ä»¶çš„å¯æ»‘åŠ¨èŒƒå›´,è€Œæœ€åçš„`make.centerX/Y.equalTo`æ˜¯é™åˆ¶æŒ‚ä»¶çš„é»˜è®¤ä½ç½®,æˆ‘è®©å®ƒé»˜è®¤åœ¨å³ä¸‹è§’,æ‰€ä»¥é€šè¿‡åç§»é‡ç§»åŠ¨è¿‡å»

> æ³¨æ„:è¿™é‡Œæœ‰ä¸ªå‘å°±æ˜¯å› ä¸ºè¿™ä¸ªä¸œè¥¿èƒ½å››å¤„æ»‘åŠ¨ æ‰€ä»¥åŸºæœ¬éœ€è¦é”å®š`left`å’Œ`top`,æˆ‘å‘ç°åªæœ‰é€šè¿‡offsetç§»åŠ¨æ‰èƒ½ç¡®å®šæœ€åˆä½ç½®,å¦‚æœequalToç›´æ¥å†™æˆxxxviewçš„bottomæˆ–è€…rightæ˜¯æ»‘åŠ¨ä¸äº†çš„,ä»”ç»†æ€è€ƒä¸€ä¸‹masonryå°±çŸ¥é“ä¸ºå•¥äº†.

ç„¶åæ·»åŠ æ‰‹åŠ¿å¹¶å®ç°ç›¸å…³æ»‘åŠ¨äº‹ä»¶å³å¯å®ç°æ»‘åŠ¨

``` objc
UIPanGestureRecognizer *pan = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(panWithGesture:)];
[self.greenView addGestureRecognizer:pan];

...

- (void)panWithGesture:(UIPanGestureRecognizer *)pan {
    CGPoint touchPoint = [pan locationInView:self.greenView];
    self.leftConstraint.offset = touchPoint.x;
    self.topConstraint.offset = touchPoint.y;
}
        
```


#### æ—·é‡Labelçš„çº¦æŸ

``` objc
[self.bubbleTitleLabel mas_remakeConstraints:^(MASConstraintMaker *make) {
	make.height.equalTo(@26);
	make.bottom.equalTo(self.widgetView.mas_top);
	make.left.greaterThanOrEqualTo(self.greenView.mas_left).offset(0);
	make.right.lessThanOrEqualTo(self.greenView.mas_right).offset(0);
	make.centerX.lessThanOrEqualTo(self.widgetView.mas_right).offset(10);
	make.centerX.greaterThanOrEqualTo(self.widgetView.mas_left).offset(-10);
}];
```

æƒ³è¦å®ç°æ—·é‡ç§»åŠ¨å¿…é¡»å¢åŠ æ›´å¤šçš„çº¦æŸé™åˆ¶

è¿™é‡Œå°±å¢åŠ äº†

``` objc
make.centerX.lessThanOrEqualTo(self.widgetView.mas_right).offset(10);
make.centerX.greaterThanOrEqualTo(self.widgetView.mas_left).offset(-10);
```

è¿™æ ·å°±å®ç°äº† å·¦å³è¶…è¿‡æ»‘åŠ¨ä¾¿å®œè¿˜ä¾ç„¶æ§åˆ¶ç€tipçš„labelå·¦å³ç§»åŠ¨èŒƒå›´.


# æ€»ç»“

ç»è¿‡å·¥ä½œä¸­é‡åˆ°çš„é—®é¢˜å®ä¾‹,å­¦ä¹ äº†ä¸€äº›Masonryçš„æŠ€å·§,å¸Œæœ›å’Œå¤§å®¶åˆ†äº«,demoæˆ‘å·²æ”¾åˆ°ä¸‹é¢ å–œæ¬¢è‡ªè¡Œä¸‹è½½å­¦ä¹ .


[demoä¸‹è½½](https://github.com/sunyazhou13/PanViewDemo)