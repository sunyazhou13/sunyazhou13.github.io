<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    
    <title>iOS抖音的转场动画 | 東引甌越</title>
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="我是孙亚洲(@sunyazhou13),一名来自北国冰城的iOS开发者,走在成为圣贤的路上.">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="iOS抖音的转场动画 | 東引甌越">
    <meta name="twitter:description" content="我是孙亚洲(@sunyazhou13),一名来自北国冰城的iOS开发者,走在成为圣贤的路上.">

    <meta property="og:type" content="article">
    <meta property="og:title" content="iOS抖音的转场动画 | 東引甌越">
    <meta property="og:description" content="我是孙亚洲(@sunyazhou13),一名来自北国冰城的iOS开发者,走在成为圣贤的路上.">

    
    <meta name="author" content="sunyazhou">
    
    <link rel="stylesheet" href="/css/vno.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">

    
    <link rel="icon" href="/images/favicon.ico">
    

    
    
    <meta name="generator" content="hexo"/>
    
    <link rel="alternate" type="application/rss+xml" title="東引甌越" href="/atom.xml">
    

    <link rel="canonical" href="https://www.sunyazhou.com/2018/12/21/20181221AwemeTransition/"/>

    
    <link rel="author" href="https://plus.google.com/107423989995616646161"/>
    
    <!-- fancybox support -->
    
        <script src="/lib/jquery-3.3.1.min.js"></script>
        <link rel="stylesheet" href="/lib/fancybox/dist/jquery.fancybox.min.css">
        <script src="/lib/fancybox/dist/jquery.fancybox.min.js"></script>
        <script src="/js/wrapImage.js"></script>
    
</head>

<body class="home-template no-js">

    <span class="mobile btn-mobile-menu">
        <i class="fa fa-list btn-mobile-menu__icon"></i>
        <i class="fa fa-angle-up btn-mobile-close__icon hidden"></i>
    </span>

    
<header class="panel-cover panel-cover--collapsed" style="background-image: url(/images/background-cover.jpg)">
  <div class="panel-main">
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        <a href="/" title="前往 東引甌越 的主页"><img src="/images/logo2.jpg" width="80" alt="東引甌越 logo" class="panel-cover__logo logo" /></a>
        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage for 東引甌越">東引甌越</a></h1>
        
        <span class="panel-cover__subtitle panel-subtitle">不断学习, 与时俱进. - 始于2017</span>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">嗨,我是孙亚洲(@sunyazhou13),一名来自北国冰城的iOS开发者,也搞过一些mac.现居帝都北京.开发数年有余,没有为往圣续绝学深感惭愧.望诸位同仁多多指教.</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />

        <div class="navigation-wrapper">
          <div>
          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="访问博客" class="blog-button">文章</a></li>
            
              <li class="navigation__item"><a href="/archives">归档</a></li>
            
              <li class="navigation__item"><a href="/projects">作品</a></li>
            
              <li class="navigation__item"><a href="/aboutme">关于</a></li>
            
            </ul>
          </nav>
          </div>
          <div>
          <nav class="cover-navigation navigation--social">
  <ul class="navigation">

  <!-- Weibo-->
  
  <li class="navigation__item">
    <a href="https://weibo.com/sunyazhou13" title="我的微博" target="_blank">
      <i class='social fa fa-weibo'></i>
      <span class="label">Weibo</span>
    </a>
  </li>


  <!-- Github -->
  
  <li class="navigation__item">
    <a href="https://github.com/sunyazhou13" title="查看我的GitHub主页" target="_blank">
      <i class='social fa fa-github'></i>
      <span class="label">Github</span>
    </a>
  </li>


<!-- Stack Overflow -->
        

  <!-- Google Plus -->
  
  <li class="navigation__item">
    <a href="https://plus.google.com/107423989995616646161" title="Google+" target="_blank">
      <i class='social fa fa-google-plus-square'></i>
      <span class="label">Google+</span>
    </a>
  </li>


<!-- Facebook -->


<!-- Twitter -->

  <li class="navigation__item">
    <a href="https://twitter.com/sunyazhou" title="上Twitter找我" target="_blank">
      <i class='social fa fa-twitter'></i>
      <span class="label">Twitter</span>
    </a>
  </li>

<!-- instagram -->


  <li class="navigation__item">
    <a href="/atom.xml" title="RSS" target="_blank">
      <i class='social fa fa-rss'></i>
      <span class="label">RSS</span>
    </a>
  </li>


  <li class="navigation__item">
    <a href="mailto:sunyazhou13@163.com" title="邮件联系我" target="_blank">
      <i class='social fa fa-envelope'></i>
      <span class="label">Email</span>
    </a>
  </li>


  </ul>
</nav>

          </div>
        </div>

      </div>

    </div>

    <div class="panel-cover--overlay cover-disabled"></div>
  </div>
</header>


    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            <article class="post-container post-container--single">

  <header class="post-header">
    <div class="post-meta">
      <time datetime="2018-12-21T02:12:07.000Z" class="post-list__meta--date date">2018-12-21</time>
 &#8226; <span class="post-meta__tags tags">分类&nbsp;
  <a class="tag-link" href="/tags/iOS开发/">iOS开发</a>, <a class="tag-link" href="/tags/抖音动画系列/">抖音动画系列</a>

</span>
    </div>
    <h1 class="post-title">iOS抖音的转场动画</h1>
  </header>

  <section class="post">
    <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>这几天比较忙,今天给大家带来的是抖音的转场动画实现 废话不多说上图</p>
<p><img src="https://raw.githubusercontent.com/sunyazhou13/sunyazhou13.github.io-images/e2c340e680ad8308f23aa1ba8d3e8197847dcfec/20181219AwemeTransition/transition1.gif" alt=""> <img src="https://ws1.sinaimg.cn/large/bf8500b1ly1fyc09rh2cog20630at7wm.gif" alt=""></p>
<p>这里需要用到前一篇文章的上下滑<a href="https://github.com/sunyazhou13/AwemeDemo" target="_blank" rel="external">demo</a></p>
<p>学习这篇文章之前推荐看下喵神的<a href="https://onevcat.com/2013/10/vc-transition-in-ios7/" target="_blank" rel="external">iOS7中的ViewController转场切换</a> </p>
<p>如果对转场不是很了解的话可能学习会有一些难度和疑问.</p>
<h2 id="转场调用代码"><a href="#转场调用代码" class="headerlink" title="转场调用代码"></a>转场调用代码</h2><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"></div><div class="line">- (<span class="keyword">void</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView didSelectItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</div><div class="line">    AwemeListViewController *awemeVC = [[AwemeListViewController alloc] init];</div><div class="line">    awemeVC.transitioningDelegate = <span class="keyword">self</span>; <span class="comment">//0</span></div><div class="line">    </div><div class="line">    <span class="comment">// 1</span></div><div class="line">    <span class="built_in">UICollectionViewCell</span> *cell = [collectionView cellForItemAtIndexPath:indexPath];</div><div class="line">    <span class="comment">// 2</span></div><div class="line">    <span class="built_in">CGRect</span> cellFrame = cell.frame;</div><div class="line">    <span class="comment">// 3</span></div><div class="line">    <span class="built_in">CGRect</span> cellConvertedFrame = [collectionView convertRect:cellFrame toView:collectionView.superview];</div><div class="line">    </div><div class="line">    <span class="comment">//弹窗转场</span></div><div class="line">    <span class="keyword">self</span>.presentScaleAnimation.cellConvertFrame = cellConvertedFrame; <span class="comment">//4</span></div><div class="line">    </div><div class="line">    <span class="comment">//消失转场</span></div><div class="line">    <span class="keyword">self</span>.dismissScaleAnimation.selectCell = cell; <span class="comment">// 5</span></div><div class="line">    <span class="keyword">self</span>.dismissScaleAnimation.originCellFrame  = cellFrame; <span class="comment">//6</span></div><div class="line">    <span class="keyword">self</span>.dismissScaleAnimation.finalCellFrame = cellConvertedFrame; <span class="comment">//7</span></div><div class="line">    </div><div class="line">    awemeVC.modalPresentationStyle = <span class="built_in">UIModalPresentationOverCurrentContext</span>; <span class="comment">//8</span></div><div class="line">    <span class="keyword">self</span>.modalPresentationStyle = <span class="built_in">UIModalPresentationCurrentContext</span>; <span class="comment">//9</span></div><div class="line">    </div><div class="line">    [<span class="keyword">self</span>.leftDragInteractiveTransition wireToViewController:awemeVC];</div><div class="line">    [<span class="keyword">self</span> presentViewController:awemeVC animated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> <code>0</code> 处代码使我们需要把当前的类做为转场的代理<br> <code>1</code> 这里我们要拿出cell这个view<br> <code>2</code> 拿出当前Cell的frame坐标<br> <code>3</code> cell的坐标转成屏幕坐标<br> <code>4</code> 设置弹出时候需要cell在屏幕的位置坐标<br> <code>5</code> 设置消失转场需要的选中cell视图<br> <code>6</code> 设置消失转场原始cell坐标位置<br> <code>7</code> 设置消失转场最终得cell屏幕坐标位置 用于消失完成回到原来位置的动画<br> <code>8</code> 设置弹出得vc弹出样式 这个用于显示弹出VC得时候 默认底部使blua的高斯模糊<br> <code>9</code> 设置当前VC的模态弹出样式为当前的弹出上下文  </p>
<blockquote>
<p>5~7 步设置的消失转场动画 下面会讲解</p>
</blockquote>
<p> 这里我们用的是前面讲上下滑的VC对象 大家不必担心 当它是一个普通的UIViewController即可</p>
<h2 id="实现转场所需要的代理"><a href="#实现转场所需要的代理" class="headerlink" title="实现转场所需要的代理"></a>实现转场所需要的代理</h2><p> 首先在需要实现<code>UIViewControllerTransitioningDelegate</code>这个代理</p>
 <figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"> <span class="meta">#pragma mark -</span></div><div class="line"><span class="meta">#pragma mark - UIViewControllerAnimatedTransitioning Delegate</span></div><div class="line">- (<span class="keyword">nullable</span> <span class="keyword">id</span> &lt;<span class="built_in">UIViewControllerAnimatedTransitioning</span>&gt;)animationControllerForPresentedController:(<span class="built_in">UIViewController</span> *)presented presentingController:(<span class="built_in">UIViewController</span> *)presenting sourceController:(<span class="built_in">UIViewController</span> *)source &#123;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.presentScaleAnimation; <span class="comment">//present VC</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">nullable</span> <span class="keyword">id</span> &lt;<span class="built_in">UIViewControllerAnimatedTransitioning</span>&gt;)animationControllerForDismissedController:(<span class="built_in">UIViewController</span> *)dismissed &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.dismissScaleAnimation; <span class="comment">//dismiss VC</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">nullable</span> <span class="keyword">id</span> &lt;<span class="built_in">UIViewControllerInteractiveTransitioning</span>&gt;)interactionControllerForDismissal:(<span class="keyword">id</span> &lt;<span class="built_in">UIViewControllerAnimatedTransitioning</span>&gt;)animator &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.leftDragInteractiveTransition.isInteracting? <span class="keyword">self</span>.leftDragInteractiveTransition: <span class="literal">nil</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> 这里面我们看到我们分别返回了</p>
<ul>
<li>弹出动画实例<code>self.presentScaleAnimation</code></li>
<li>dismiss动画实例<code>self.dismissScaleAnimation</code></li>
<li><p>以及<code>self.leftDragInteractiveTransition</code>实例用于负责转场切换的具体实现</p>
<p>所以我们需要在 当前的VC中声明3个成员变量 并初始化</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) PresentScaleAnimation *presentScaleAnimation;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) DismissScaleAnimation *dismissScaleAnimation;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) DragLeftInteractiveTransition *leftDragInteractiveTransition;</div></pre></td></tr></table></figure>
</li>
</ul>
<p> 并在<code>viewDidLoad:</code>方法中初始化一下</p>
 <figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"> <span class="comment">//转场的两个动画</span></div><div class="line"><span class="keyword">self</span>.presentScaleAnimation = [[PresentScaleAnimation alloc] init];</div><div class="line"><span class="keyword">self</span>.dismissScaleAnimation = [[DismissScaleAnimation alloc] init];</div><div class="line"><span class="keyword">self</span>.leftDragInteractiveTransition = [DragLeftInteractiveTransition new];</div></pre></td></tr></table></figure>
<p> 这里我说一下这三个成员都负责啥事</p>
<p> 首先<code>DragLeftInteractiveTransition</code>类负责转场的 手势 过程,就是pan手势在这个类里面实现,并继承自<code>UIPercentDrivenInteractiveTransition</code>类,这是iOS7以后系统提供的转场基类必须在<code>interactionControllerForDismissal:</code>代理协议中返回这个类或者子类的实例对象,所以我们生成一个成员变量<code>self.leftDragInteractiveTransition</code></p>
<p> 其次是弹出present和消失dismiss的动画类,这俩类其实是负责简单的手势完成之后的动画.</p>
<p> 这两个类都是继承自NSObject并实现<code>UIViewControllerAnimatedTransitioning</code>协议的类,这个协议里面有 需要你复写某些方法返回具体的动画执行时间,和中间过程中我们需要的相关的容器视图以及控制器的视图实例,当我们自己执行完成之后调用相关的block回答告知转场是否完成就行了.</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"> <span class="class"><span class="keyword">@implementation</span> <span class="title">PresentScaleAnimation</span></span></div><div class="line"></div><div class="line">- (<span class="built_in">NSTimeInterval</span>)transitionDuration:(<span class="keyword">id</span> &lt;<span class="built_in">UIViewControllerContextTransitioning</span>&gt;)transitionContext&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">0.3</span>f;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)animateTransition:(<span class="keyword">id</span> &lt;<span class="built_in">UIViewControllerContextTransitioning</span>&gt;)transitionContext&#123;</div><div class="line">    <span class="built_in">UIViewController</span> *toVC = [transitionContext viewControllerForKey:<span class="built_in">UITransitionContextToViewControllerKey</span>];    </div><div class="line">    <span class="keyword">if</span> (<span class="built_in">CGRectEqualToRect</span>(<span class="keyword">self</span>.cellConvertFrame, <span class="built_in">CGRectZero</span>)) &#123;</div><div class="line">        [transitionContext completeTransition:<span class="literal">YES</span>];</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">CGRect</span> initialFrame = <span class="keyword">self</span>.cellConvertFrame;</div><div class="line"></div><div class="line">    <span class="built_in">UIView</span> *containerView = [transitionContext containerView];</div><div class="line">    [containerView addSubview:toVC.view];</div><div class="line"></div><div class="line">    <span class="built_in">CGRect</span> finalFrame = [transitionContext finalFrameForViewController:toVC];</div><div class="line">    <span class="built_in">NSTimeInterval</span> duration = [<span class="keyword">self</span> transitionDuration:transitionContext];</div><div class="line"></div><div class="line">    toVC.view.center = <span class="built_in">CGPointMake</span>(initialFrame.origin.x + initialFrame.size.width/<span class="number">2</span>, initialFrame.origin.y + initialFrame.size.height/<span class="number">2</span>);</div><div class="line">    toVC.view.transform = <span class="built_in">CGAffineTransformMakeScale</span>(initialFrame.size.width/finalFrame.size.width, initialFrame.size.height/finalFrame.size.height);</div><div class="line"></div><div class="line">    [<span class="built_in">UIView</span> animateWithDuration:duration</div><div class="line">                          delay:<span class="number">0</span></div><div class="line">         usingSpringWithDamping:<span class="number">0.8</span></div><div class="line">          initialSpringVelocity:<span class="number">1</span></div><div class="line">                        options:<span class="built_in">UIViewAnimationOptionLayoutSubviews</span></div><div class="line">                     animations:^&#123;</div><div class="line">                         toVC.view.center = <span class="built_in">CGPointMake</span>(finalFrame.origin.x + finalFrame.size.width/<span class="number">2</span>, finalFrame.origin.y + finalFrame.size.height/<span class="number">2</span>);</div><div class="line">                         toVC.view.transform = <span class="built_in">CGAffineTransformMakeScale</span>(<span class="number">1</span>, <span class="number">1</span>);</div><div class="line">                     &#125; completion:^(<span class="built_in">BOOL</span> finished) &#123;</div><div class="line">                         [transitionContext completeTransition:<span class="literal">YES</span>];</div><div class="line">                     &#125;];</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>很简单.</p>
<p>消失的动画 同上边差不多</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">DismissScaleAnimation</span> ()</span></div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">DismissScaleAnimation</span></span></div><div class="line"></div><div class="line">- (<span class="keyword">instancetype</span>)init &#123;</div><div class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</div><div class="line">        _centerFrame = <span class="built_in">CGRectMake</span>((ScreenWidth - <span class="number">5</span>)/<span class="number">2</span>, (ScreenHeight - <span class="number">5</span>)/<span class="number">2</span>, <span class="number">5</span>, <span class="number">5</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">NSTimeInterval</span>)transitionDuration:(<span class="keyword">id</span> &lt;<span class="built_in">UIViewControllerContextTransitioning</span>&gt;)transitionContext&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">0.25</span>f;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)animateTransition:(<span class="keyword">id</span> &lt;<span class="built_in">UIViewControllerContextTransitioning</span>&gt;)transitionContext&#123;</div><div class="line">    <span class="built_in">UIViewController</span> *fromVC = [transitionContext viewControllerForKey:<span class="built_in">UITransitionContextFromViewControllerKey</span>];</div><div class="line"><span class="comment">//    UINavigationController *toNavigation = (UINavigationController *)[transitionContext viewControllerForKey:UITransitionContextToViewControllerKey];</span></div><div class="line"><span class="comment">//    UIViewController *toVC = [toNavigation viewControllers].firstObject;</span></div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="built_in">UIView</span> *snapshotView;</div><div class="line">    <span class="built_in">CGFloat</span> scaleRatio;</div><div class="line">    <span class="built_in">CGRect</span> finalFrame = <span class="keyword">self</span>.finalCellFrame;</div><div class="line">    <span class="keyword">if</span>(<span class="keyword">self</span>.selectCell &amp;&amp; !<span class="built_in">CGRectEqualToRect</span>(finalFrame, <span class="built_in">CGRectZero</span>)) &#123;</div><div class="line">        snapshotView = [<span class="keyword">self</span>.selectCell snapshotViewAfterScreenUpdates:<span class="literal">NO</span>];</div><div class="line">        scaleRatio = fromVC.view.frame.size.width/<span class="keyword">self</span>.selectCell.frame.size.width;</div><div class="line">        snapshotView.layer.zPosition = <span class="number">20</span>;</div><div class="line">    &#125;<span class="keyword">else</span> &#123;</div><div class="line">        snapshotView = [fromVC.view snapshotViewAfterScreenUpdates:<span class="literal">NO</span>];</div><div class="line">        scaleRatio = fromVC.view.frame.size.width/ScreenWidth;</div><div class="line">        finalFrame = _centerFrame;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="built_in">UIView</span> *containerView = [transitionContext containerView];</div><div class="line">    [containerView addSubview:snapshotView];</div><div class="line">    </div><div class="line">    <span class="built_in">NSTimeInterval</span> duration = [<span class="keyword">self</span> transitionDuration:transitionContext];</div><div class="line">    </div><div class="line">    fromVC.view.alpha = <span class="number">0.0</span>f;</div><div class="line">    snapshotView.center = fromVC.view.center;</div><div class="line">    snapshotView.transform = <span class="built_in">CGAffineTransformMakeScale</span>(scaleRatio, scaleRatio);</div><div class="line">    [<span class="built_in">UIView</span> animateWithDuration:duration</div><div class="line">                          delay:<span class="number">0</span></div><div class="line">         usingSpringWithDamping:<span class="number">0.8</span></div><div class="line">          initialSpringVelocity:<span class="number">0.2</span></div><div class="line">                        options:<span class="built_in">UIViewAnimationOptionCurveEaseInOut</span></div><div class="line">                     animations:^&#123;</div><div class="line">                         snapshotView.transform = <span class="built_in">CGAffineTransformMakeScale</span>(<span class="number">1.0</span>f, <span class="number">1.0</span>f);</div><div class="line">                         snapshotView.frame = finalFrame;</div><div class="line">                     &#125; completion:^(<span class="built_in">BOOL</span> finished) &#123;</div><div class="line">                         [transitionContext finishInteractiveTransition];</div><div class="line">                         [transitionContext completeTransition:<span class="literal">YES</span>];</div><div class="line">                         [snapshotView removeFromSuperview];</div><div class="line">                     &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>我们重点需要说一下 转场过渡的类<code>DragLeftInteractiveTransition</code>继承自<code>UIPercentDrivenInteractiveTransition</code>负责转场过程,</p>
<p>头文件的声明</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">DragLeftInteractiveTransition</span> : <span class="title">UIPercentDrivenInteractiveTransition</span></span></div><div class="line"></div><div class="line"><span class="comment">/** 是否正在拖动返回 标识是否正在使用转场的交互中 */</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> isInteracting;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> 设置需要返回的VC</div><div class="line"> </div><div class="line"> @param viewController 控制器实例</div><div class="line"> */</div><div class="line">-(<span class="keyword">void</span>)wireToViewController:(<span class="built_in">UIViewController</span> *)viewController;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>实现</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">DragLeftInteractiveTransition</span> ()</span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIViewController</span> *presentingVC;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGPoint</span> viewControllerCenter;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">CALayer</span> *transitionMaskLayer;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">DragLeftInteractiveTransition</span></span></div><div class="line"></div><div class="line"><span class="meta">#pragma mark -</span></div><div class="line"><span class="meta">#pragma mark - override methods 复写方法</span></div><div class="line">-(<span class="built_in">CGFloat</span>)completionSpeed&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span> - <span class="keyword">self</span>.percentComplete;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)updateInteractiveTransition:(<span class="built_in">CGFloat</span>)percentComplete &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%.2f"</span>,percentComplete);</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)cancelInteractiveTransition &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"转场取消"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)finishInteractiveTransition &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"转场完成"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="built_in">CALayer</span> *)transitionMaskLayer &#123;</div><div class="line">    <span class="keyword">if</span> (_transitionMaskLayer == <span class="literal">nil</span>) &#123;</div><div class="line">        _transitionMaskLayer = [<span class="built_in">CALayer</span> layer];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> _transitionMaskLayer;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">#pragma mark -</span></div><div class="line"><span class="meta">#pragma mark - private methods 私有方法</span></div><div class="line">- (<span class="keyword">void</span>)prepareGestureRecognizerInView:(<span class="built_in">UIView</span>*)view &#123;</div><div class="line">    <span class="built_in">UIPanGestureRecognizer</span> *gesture = [[<span class="built_in">UIPanGestureRecognizer</span> alloc] initWithTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(handleGesture:)];</div><div class="line">    [view addGestureRecognizer:gesture];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">#pragma mark -</span></div><div class="line"><span class="meta">#pragma mark - event response 所有触发的事件响应 按钮、通知、分段控件等</span></div><div class="line">- (<span class="keyword">void</span>)handleGesture:(<span class="built_in">UIPanGestureRecognizer</span> *)gestureRecognizer &#123;</div><div class="line">    <span class="built_in">UIView</span> *vcView = gestureRecognizer.view;</div><div class="line">    <span class="built_in">CGPoint</span> translation = [gestureRecognizer translationInView:vcView.superview];</div><div class="line">    <span class="keyword">if</span>(!<span class="keyword">self</span>.isInteracting &amp;&amp;</div><div class="line">       (translation.x &lt; <span class="number">0</span> ||</div><div class="line">        translation.y &lt; <span class="number">0</span> ||</div><div class="line">        translation.x &lt; translation.y)) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">switch</span> (gestureRecognizer.state) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="built_in">UIGestureRecognizerStateBegan</span>:&#123;</div><div class="line">            <span class="comment">//修复当从右侧向左滑动的时候的bug 避免开始的时候从又向左滑动 当未开始的时候</span></div><div class="line">            <span class="built_in">CGPoint</span> vel = [gestureRecognizer velocityInView:gestureRecognizer.view];</div><div class="line">            <span class="keyword">if</span> (!<span class="keyword">self</span>.isInteracting &amp;&amp; vel.x &lt; <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">self</span>.isInteracting = <span class="literal">NO</span>;</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">self</span>.transitionMaskLayer.frame = vcView.frame;</div><div class="line">            <span class="keyword">self</span>.transitionMaskLayer.opaque = <span class="literal">NO</span>;</div><div class="line">            <span class="keyword">self</span>.transitionMaskLayer.opacity = <span class="number">1</span>;</div><div class="line">            <span class="keyword">self</span>.transitionMaskLayer.backgroundColor = [<span class="built_in">UIColor</span> whiteColor].CGColor; <span class="comment">//必须有颜色不能透明</span></div><div class="line">            [<span class="keyword">self</span>.transitionMaskLayer setNeedsDisplay];</div><div class="line">            [<span class="keyword">self</span>.transitionMaskLayer displayIfNeeded];</div><div class="line">            <span class="keyword">self</span>.transitionMaskLayer.anchorPoint = <span class="built_in">CGPointMake</span>(<span class="number">0.5</span>, <span class="number">0.5</span>);</div><div class="line">            <span class="keyword">self</span>.transitionMaskLayer.position = <span class="built_in">CGPointMake</span>(vcView.frame.size.width/<span class="number">2.0</span>f, vcView.frame.size.height/<span class="number">2.0</span>f);</div><div class="line">            vcView.layer.mask = <span class="keyword">self</span>.transitionMaskLayer;</div><div class="line">            vcView.layer.masksToBounds = <span class="literal">YES</span>;</div><div class="line">            </div><div class="line">            <span class="keyword">self</span>.isInteracting = <span class="literal">YES</span>;</div><div class="line">        &#125;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="built_in">UIGestureRecognizerStateChanged</span>: &#123;</div><div class="line">            <span class="built_in">CGFloat</span> progress = translation.x / [<span class="built_in">UIScreen</span> mainScreen].bounds.size.width;</div><div class="line">            progress = fminf(fmaxf(progress, <span class="number">0.0</span>), <span class="number">1.0</span>);</div><div class="line">            </div><div class="line">            <span class="built_in">CGFloat</span> ratio = <span class="number">1.0</span>f - progress*<span class="number">0.5</span>f;</div><div class="line">            [_presentingVC.view setCenter:<span class="built_in">CGPointMake</span>(_viewControllerCenter.x + translation.x * ratio, _viewControllerCenter.y + translation.y * ratio)];</div><div class="line">            _presentingVC.view.transform = <span class="built_in">CGAffineTransformMakeScale</span>(ratio, ratio);</div><div class="line">            [<span class="keyword">self</span> updateInteractiveTransition:progress];</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">case</span> <span class="built_in">UIGestureRecognizerStateCancelled</span>:</div><div class="line">        <span class="keyword">case</span> <span class="built_in">UIGestureRecognizerStateEnded</span>:&#123;</div><div class="line">            <span class="built_in">CGFloat</span> progress = translation.x / [<span class="built_in">UIScreen</span> mainScreen].bounds.size.width;</div><div class="line">            progress = fminf(fmaxf(progress, <span class="number">0.0</span>), <span class="number">1.0</span>);</div><div class="line">            <span class="keyword">if</span> (progress &lt; <span class="number">0.2</span>)&#123;</div><div class="line">                [<span class="built_in">UIView</span> animateWithDuration:progress</div><div class="line">                                      delay:<span class="number">0</span></div><div class="line">                                    options:<span class="built_in">UIViewAnimationOptionCurveEaseOut</span></div><div class="line">                                 animations:^&#123;</div><div class="line">                                     <span class="built_in">CGFloat</span> w = [<span class="built_in">UIScreen</span> mainScreen].bounds.size.width;</div><div class="line">                                     <span class="built_in">CGFloat</span> h = [<span class="built_in">UIScreen</span> mainScreen].bounds.size.height;</div><div class="line">                                     [<span class="keyword">self</span>.presentingVC.view setCenter:<span class="built_in">CGPointMake</span>(w/<span class="number">2</span>, h/<span class="number">2</span>)];</div><div class="line">                                     <span class="keyword">self</span>.presentingVC.view.transform = <span class="built_in">CGAffineTransformMakeScale</span>(<span class="number">1.0</span>f, <span class="number">1.0</span>f);</div><div class="line">                                 &#125; completion:^(<span class="built_in">BOOL</span> finished) &#123;</div><div class="line">                                     <span class="keyword">self</span>.isInteracting = <span class="literal">NO</span>;</div><div class="line">                                     [<span class="keyword">self</span> cancelInteractiveTransition];</div><div class="line">                                 &#125;];</div><div class="line">            &#125;<span class="keyword">else</span> &#123;</div><div class="line">                _isInteracting = <span class="literal">NO</span>;</div><div class="line">                [<span class="keyword">self</span> finishInteractiveTransition];</div><div class="line">                [_presentingVC dismissViewControllerAnimated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</div><div class="line">            &#125;</div><div class="line">            <span class="comment">//移除 遮罩</span></div><div class="line">            [<span class="keyword">self</span>.transitionMaskLayer removeFromSuperlayer];</div><div class="line">            <span class="keyword">self</span>.transitionMaskLayer = <span class="literal">nil</span>;</div><div class="line">        &#125;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">#pragma mark -</span></div><div class="line"><span class="meta">#pragma mark - public methods 公有方法</span></div><div class="line">-(<span class="keyword">void</span>)wireToViewController:(<span class="built_in">UIViewController</span> *)viewController &#123;</div><div class="line">    <span class="keyword">self</span>.presentingVC = viewController;</div><div class="line">    <span class="keyword">self</span>.viewControllerCenter = viewController.view.center;</div><div class="line">    [<span class="keyword">self</span> prepareGestureRecognizerInView:viewController.view];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>我们对外提供了一个<code>wireToViewController:</code>方法用于外部需要创建转场使用.</p>
<p>前面的代码我们发现有一处</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">[<span class="keyword">self</span>.leftDragInteractiveTransition wireToViewController:awemeVC];</div><div class="line">[<span class="keyword">self</span> presentViewController:awemeVC animated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<p>这里就是需要把我们要弹出的上下滑VC实例传进来,进来之后为VC的<code>self.view</code>加个<code>pan</code>手势,</p>
<p>复写方法中我们可以看到相关开始结束 完成过程的百分比相关方法复写</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="meta">#pragma mark -</span></div><div class="line"><span class="meta">#pragma mark - override methods 复写方法</span></div><div class="line">-(<span class="built_in">CGFloat</span>)completionSpeed&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span> - <span class="keyword">self</span>.percentComplete;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)updateInteractiveTransition:(<span class="built_in">CGFloat</span>)percentComplete &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%.2f"</span>,percentComplete);</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)cancelInteractiveTransition &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"转场取消"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)finishInteractiveTransition &#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"转场完成"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>看是手势 出发前 先检查一下是否如下条件</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="built_in">UIView</span> *vcView = gestureRecognizer.view;</div><div class="line"><span class="built_in">CGPoint</span> translation = [gestureRecognizer translationInView:vcView.superview];</div><div class="line"><span class="keyword">if</span>(!<span class="keyword">self</span>.isInteracting &amp;&amp;</div><div class="line">   (translation.x &lt; <span class="number">0</span> ||</div><div class="line">    translation.y &lt; <span class="number">0</span> ||</div><div class="line">    translation.x &lt; translation.y)) &#123;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>拿出手势作用的视图,然后坐标转换,判断当前是否已经开始了动画,如果没开始 或者x坐标 &lt; y坐标是判断当前是否是超过边界范围等等异常case处理.</p>
<p>开始的时候需要注意下</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//修复当从右侧向左滑动的时候的bug 避免开始的时候从又向左滑动 当未开始的时候</span></div><div class="line"><span class="built_in">CGPoint</span> vel = [gestureRecognizer velocityInView:gestureRecognizer.view];</div><div class="line"><span class="keyword">if</span> (!<span class="keyword">self</span>.isInteracting &amp;&amp; vel.x &lt; <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">self</span>.isInteracting = <span class="literal">NO</span>;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后 开始的时候加个蒙版做为view.mask 这样是为了解决tableView 超出contentSize的范围要隐藏</p>
<p>剩下的就是中间过程 </p>
<p><strong>关键的核心代码</strong></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">[<span class="keyword">self</span> updateInteractiveTransition:progress];</div></pre></td></tr></table></figure>
<blockquote>
<p>更新转场的进度 这是这个类的自带方法,调用就行了</p>
</blockquote>
<p>最后 手势结束</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="built_in">CGFloat</span> progress = translation.x / [<span class="built_in">UIScreen</span> mainScreen].bounds.size.width;</div><div class="line">progress = fminf(fmaxf(progress, <span class="number">0.0</span>), <span class="number">1.0</span>);</div><div class="line"><span class="keyword">if</span> (progress &lt; <span class="number">0.2</span>)&#123;</div><div class="line">    [<span class="built_in">UIView</span> animateWithDuration:progress</div><div class="line">                          delay:<span class="number">0</span></div><div class="line">                        options:<span class="built_in">UIViewAnimationOptionCurveEaseOut</span></div><div class="line">                     animations:^&#123;</div><div class="line">                         <span class="built_in">CGFloat</span> w = [<span class="built_in">UIScreen</span> mainScreen].bounds.size.width;</div><div class="line">                         <span class="built_in">CGFloat</span> h = [<span class="built_in">UIScreen</span> mainScreen].bounds.size.height;</div><div class="line">                         [<span class="keyword">self</span>.presentingVC.view setCenter:<span class="built_in">CGPointMake</span>(w/<span class="number">2</span>, h/<span class="number">2</span>)];</div><div class="line">                         <span class="keyword">self</span>.presentingVC.view.transform = <span class="built_in">CGAffineTransformMakeScale</span>(<span class="number">1.0</span>f, <span class="number">1.0</span>f);</div><div class="line">                     &#125; completion:^(<span class="built_in">BOOL</span> finished) &#123;</div><div class="line">                         <span class="keyword">self</span>.isInteracting = <span class="literal">NO</span>;</div><div class="line">                         [<span class="keyword">self</span> cancelInteractiveTransition];</div><div class="line">                     &#125;];</div><div class="line">&#125;<span class="keyword">else</span> &#123;</div><div class="line">    _isInteracting = <span class="literal">NO</span>;</div><div class="line">    [<span class="keyword">self</span> finishInteractiveTransition];</div><div class="line">    [_presentingVC dismissViewControllerAnimated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</div><div class="line">&#125;</div><div class="line"><span class="comment">//移除 遮罩</span></div><div class="line">[<span class="keyword">self</span>.transitionMaskLayer removeFromSuperlayer];</div><div class="line"><span class="keyword">self</span>.transitionMaskLayer = <span class="literal">nil</span>;</div></pre></td></tr></table></figure>
<blockquote>
<p>这里设置0.2的容差 如果你觉得这个应该开放接口设置可自行封装.</p>
</blockquote>
<p>当用户取消的话记得调用<code>cancelInteractiveTransition</code>方法取消</p>
<p>完成的话调用<code>finishInteractiveTransition</code>完成转场</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>整个过程还是比较简单的 如果看过喵神的文章将会更加清晰的了解转场的三个过程<br>就是 弹出和消失动画 以及一个中间转场过程需要我们熟悉.</p>
<p>优化点: 在原开源工程中的demo转场右滑是有bug的,我做了一下如下判断</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//修复当从右侧向左滑动的时候的bug 避免开始的时候从又向左滑动 当未开始的时候</span></div><div class="line"><span class="built_in">CGPoint</span> vel = [gestureRecognizer velocityInView:gestureRecognizer.view];</div><div class="line"><span class="keyword">if</span> (!<span class="keyword">self</span>.isInteracting &amp;&amp; vel.x &lt; <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">self</span>.isInteracting = <span class="literal">NO</span>;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>vel</code>这个变量 其实是判断当我们从右侧划入返回.修复了原来开源的一个bug</p>
<p>还有 原来开源中<code>tableView</code>的<code>contentSize</code>以外 区域露在外部,我用了一个mask的蒙版遮住了显示在外的区域.</p>
<p>唯一有些许遗憾的地方是抖音的左滑返回时候,有背景遮盖透明的渐变.这里由于时间关系和篇幅限制我没有花足够的时间调研.后续完善,写的不好请大家多多指教</p>
<p><a href="https://github.com/sunyazhou13/AwemeDemoTransition" target="_blank" rel="external">最终得Demo在这里</a></p>

  </section>

</article>


    <! -- 添加捐赠图标 -->
<div class ="post-donate">
    <div id="donate_board" class="donate_bar center">
        <a id="btn_donate" class="btn_donate" href="javascript:;" title="打赏"></a>
        <span class="donate_txt">
           ↑<br>
           欣赏此文？求鼓励，求支持！
        </span>
        <br>
    </div>  
    <div id="donate_guide" class="donate_bar center hidden" >
        <!-- 方式一： 
            ![](/img/Alipay.jpg)
            ![](/img/WeChatpay.jpg)
        -->
        <!-- 方式二；
            step1：在_config.yml中添加配置
                Alipay: /img/Alipay.jpg
                WeChatpay: /img/WeChatpay.jpg
            step2：此处两张图片的路径分别设置为如下
                <img src="undefined"
                <img src="undefined"
        -->
        <!-- 支付宝打赏图案 -->
        <img src="/images/Alipay.jpg" alt="支付宝打赏">
        <!-- 微信打赏图案 -->
        <img src="/images/WeChatpay.jpg" alt="微信打赏">
    </div>
    <script type="text/javascript">
        document.getElementById('btn_donate').onclick = function(){
            $('#donate_board').addClass('hidden');
            $('#donate_guide').removeClass('hidden');
        }
    </script>
</div>

<! -- 添加捐赠图标 -->



<section class="read-more">
     
        
            <div class="read-more-item">
                <span class="read-more-item-dim">最近的文章</span>
                <h2 class="post-list__post-title post-title"><a href="/2018/12/28/20181228FinalSummary/" title="2018年终总结">2018年终总结</a></h2>
                <p class="excerpt">
                
                
前言
埋头苦干尽五年,晨起面镜白发先.一年到头不见泪,岁月荏苒冬却寒.仿佛回到一三年,北京站前望着天.北漂掘金那刻起,人生已无再少年.


我要是能像你那么潇洒就好了,有时候你能做的事情我却做不到,我相信正义,可是没人相信我…
这一年过的像网速一样快,看着年末又到了,我依然得墨守陈规的交出我的20
                &hellip;
                </p>
                <div class="post-list__meta"><time datetime="2018-12-28T15:04:41.000Z" class="post-list__meta--date date">2018-12-28</time>
 &#8226; <span class="post-list__meta--tags tags">于&nbsp;
  <a class="tag-link" href="/tags/年终总结/">年终总结</a>, <a class="tag-link" href="/tags/生活/">生活</a>

</span><a class="btn-border-small" href="/2018/12/28/20181228FinalSummary/">继续阅读</a></div>

            </div>
        

        
            <div class="read-more-item">
                <span class="read-more-item-dim">更早的文章</span>
                <h2 class="post-list__post-title post-title"><a href="/2018/12/06/20181206Detecting-pan-gesture-direction/" title="探测UIPanGesture的滑动方向">探测UIPanGesture的滑动方向</a></h2>
                <p class="excerpt">
                
                前言这几天遇到一个问题 就是拖动手势作用在一个view上的时候 无法区分方向
于是找到stackOverFlow上的答案 记录一下
- (void)panRecognized:(UIPanGestureRecognizer *)rec&amp;#123;    CGPoint vel = [rec velo
                &hellip;
                </p>
                <div class="post-list__meta"><time datetime="2018-12-06T05:59:46.000Z" class="post-list__meta--date date">2018-12-06</time>
 &#8226; <span class="post-list__meta--tags tags">于&nbsp;
  <a class="tag-link" href="/tags/iOS开发/">iOS开发</a>

</span><a class="btn-border-small" href="/2018/12/06/20181206Detecting-pan-gesture-direction/">继续阅读</a></div>

            </div>
        
   
</section>



  <div id="gitalk-container" style="padding: 0px 30px 0px 30px;"></div> 

  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
  <script type="text/javascript">

  if(true){
    var gitalk = new Gitalk({
      clientID: '15c55ed469ea673ae332',
      clientSecret: '1801dbf9b1589c256260c85d779eb51d0cf40885',
      repo: 'gitment-comments',
      owner: 'sunyazhou13',
      admin: ['sunyazhou13'],
      id: 'Fri Dec 21 2018 10:12:07 GMT+0800',
      distractionFreeMode: 'true'
  })
  gitalk.render('gitalk-container') 
  }
  </script>




            <footer class="footer">
    <span class="footer__copyright">
        本站点采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>
    </span>
    <span class="footer__copyright">
        基于 <a href="http://hexo.io">Hexo</a> 搭建，感谢 <a href="https://pages.github.com/">GitHub Pages</a> 和 Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a> 提供免费的托管服务
    </span>
    <span class="footer__copyright">
        &copy; 2019 - 本站由 <a href="/">@sunyazhou13</a> 创建,
        使用<a href="https://github.com/lenbo-ma/hexo-theme-vno">hexo-theme-vno</a>主题,
        修改自<a href="https://github.com/onevcat/vno" target="_blank">喵神的vno</a>
    </span>
</footer>

        </div>
    </div>

    <script src="https://cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
    <script src="/js/main.js"></script>

     




    


    

<script type="text/javascript">

// var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
// document.write(unescape("%3Cspan id='cnzz_stat_icon_1274885345'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s13.cnzz.com/z_stat.php%3Fid%3D1274885345%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));

var cnzz_s_tag = document.createElement('script');
cnzz_s_tag.type = 'text/javascript';
cnzz_s_tag.async = true;
cnzz_s_tag.charset = "utf-8";
cnzz_s_tag.src = src="https://s13.cnzz.com/z_stat.php?id=1274885345&web_id=1274885345&async=1";
var root_s = document.getElementsByTagName('script')[0];
root_s.parentNode.insertBefore(cnzz_s_tag, root_s);

</script>


</body>
</html>
